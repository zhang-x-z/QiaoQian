{"version":3,"sources":["webpack:///./src/views/Mobile/process/FaceProc.vue?a1c6","webpack:///./src/views/Mobile/process/FaceProc.vue?14c8","webpack:///src/views/Mobile/process/FaceProc.vue","webpack:///./src/views/Mobile/process/FaceProc.vue?9602","webpack:///./src/views/Mobile/process/FaceProc.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","scopedSlots","_u","key","fn","on","back","proxy","_v","_s","currentModule","finish","directives","name","rawName","value","expression","attrs","ref","userImg","handleClick","model","callback","$$v","_l","item","handleSubClick","currentSubModule","subitem","staticRenderFns","a","components","NavBar","data","fullScreenLoading","modules","subModules","savedImg","degreeList","mounted","reset","methods","$router","$store","commit","state","editedImg","form","append","error_code","console","log","err","index","activated","component"],"mappings":"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","file":"js/chunk-23d8c498.094f2bb4.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FaceProc.vue?vue&type=style&index=0&id=7b323f56&lang=css&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FaceProc.vue?vue&type=style&index=0&id=7b323f56&lang=css&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"face-proc\"},[_c('el-header',[_c('nav-bar',{scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('i',{staticClass:\"el-icon-close\",on:{\"click\":_vm.back}})]},proxy:true},{key:\"center\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.currentModule))])]},proxy:true},{key:\"right\",fn:function(){return [_c('i',{staticClass:\"el-icon-check\",on:{\"click\":_vm.finish}})]},proxy:true}])})],1),_c('el-main',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.fullScreenLoading),expression:\"fullScreenLoading\"}],attrs:{\"element-loading-text\":\"处理中...\",\"element-loading-background\":\"rgba(0, 0, 0, 0.6)\"}},[_c('div',{staticClass:\"img-container\"},[_c('img',{ref:\"image\",attrs:{\"src\":_vm.userImg,\"id\":\"image\"}})])]),_c('el-footer',{staticClass:\"tabs\"},[_c('el-tabs',{attrs:{\"tab-position\":\"bottom\"},on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.currentModule),callback:function ($$v) {_vm.currentModule=$$v},expression:\"currentModule\"}},[_vm._l((_vm.modules),function(item){return [_c('el-tab-pane',{attrs:{\"label\":item,\"name\":item}},[[_c('el-radio-group',{staticClass:\"sub-modules\",on:{\"change\":_vm.handleSubClick},model:{value:(_vm.currentSubModule),callback:function ($$v) {_vm.currentSubModule=$$v},expression:\"currentSubModule\"}},[(_vm.currentModule!=='瘦脸')?_c('div',[_vm._l((_vm.subModules),function(subitem){return [_c('el-radio-button',{key:subitem,attrs:{\"label\":subitem,\"size\":\"mini\"}},[_vm._v(_vm._s(subitem))])]})],2):_c('div',[[_c('el-radio-button',{attrs:{\"label\":'重置',\"size\":\"mini\"}},[_vm._v(\"重置\")])]],2)])]],2)]})],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"face-proc\">\r\n    <el-header>\r\n      <nav-bar>\r\n        <template v-slot:left>\r\n          <i class=\"el-icon-close\" @click=\"back\"></i>\r\n        </template>\r\n        <template v-slot:center>\r\n          <span>{{currentModule}}</span>\r\n        </template>\r\n        <template v-slot:right>\r\n          <i class=\"el-icon-check\" @click=\"finish\"></i>\r\n        </template>\r\n      </nav-bar>\r\n    </el-header>\r\n    <el-main\r\n      v-loading=\"fullScreenLoading\"\r\n      element-loading-text=\"处理中...\"\r\n      element-loading-background=\"rgba(0, 0, 0, 0.6)\"\r\n    >\r\n      <div class=\"img-container\">\r\n        <img :src=\"userImg\" id=\"image\" ref=\"image\" />\r\n      </div>\r\n    </el-main>\r\n    <el-footer class=\"tabs\">\r\n      <el-tabs tab-position=\"bottom\" @tab-click=\"handleClick\" v-model=\"currentModule\">\r\n        <template v-for=\"item in modules\">\r\n          <el-tab-pane :label=\"item\" :name=\"item\">\r\n            <template>\r\n              <el-radio-group\r\n                class=\"sub-modules\"\r\n                v-model=\"currentSubModule\"\r\n                @change=\"handleSubClick\"\r\n              >\r\n                <div v-if=\"currentModule!=='瘦脸'\">\r\n                  <template v-for=\"subitem in subModules\">\r\n                    <el-radio-button :label=\"subitem\" size=\"mini\" :key=\"subitem\">{{subitem}}</el-radio-button>\r\n                  </template>\r\n                </div>\r\n                <div v-else>\r\n                  <template>\r\n                    <el-radio-button :label=\"'重置'\" size=\"mini\">重置</el-radio-button>\r\n                  </template>\r\n                </div>\r\n              </el-radio-group>\r\n            </template>\r\n          </el-tab-pane>\r\n        </template>\r\n      </el-tabs>\r\n    </el-footer>\r\n  </div>\r\n</template>\r\n<script>\r\nimport NavBar from 'components/common/Mobile/NavBar.vue'\r\nimport axios from 'axios'\r\nimport { baseurl } from '@/utils.js'\r\n//TODO: need to change\r\naxios.defaults.baseURL = baseurl()\r\n\r\nexport default {\r\n  name: \"FaceProc\",\r\n  components: {\r\n    NavBar\r\n  },\r\n  data () {\r\n    return {\r\n      fullScreenLoading: false,\r\n      modules: ['磨皮', '美白', '瘦脸'],\r\n      subModules: ['重置', '1级', '2级', '3级', '4级', '5级'],\r\n      currentModule: '瘦脸',\r\n      currentSubModule: '',\r\n      userImg: '',\r\n      savedImg: '',\r\n      // degreeList数组用来存degree参数，和上面的数组下标对应，-1代表重置\r\n      degreeList: [[-1, 1, 2, 3, 4, 5], [-1, 5, 10, 15, 20, 25], [-1, 1, 2, 3, 4, 5]]\r\n    }\r\n  },\r\n  mounted () {\r\n    this.currentModule = '磨皮'\r\n    this.reset()\r\n  },\r\n  methods: {\r\n    back () {\r\n      // 直接返回上层\r\n      this.$router.back()\r\n      // console.log('取消操作')\r\n    },\r\n    finish () {\r\n      // TODO：保存图片效果到store\r\n      this.$store.commit('saveImg', this.userImg)\r\n      // console.log('保存图片成功')\r\n      this.$router.back()\r\n    },\r\n    reset () {\r\n      this.userImg = this.$store.state.editedImg\r\n      this.savedImg = this.$store.state.editedImg\r\n      this.currentSubModule = ''\r\n    },\r\n    handleClick (tab) {\r\n      // 响应父栏点击,每次切换功能都需要重置美颜效果\r\n      this.currentSubModule = ''\r\n      this.savedImg = this.userImg\r\n      // console.log('点击底部的 ' + tab.label)\r\n      if (this.currentModule === '瘦脸') {\r\n        this.fullScreenLoading = true\r\n        let form = new FormData()\r\n        form.append('editedImg', this.savedImg)\r\n        axios.post('imgProc/face_thin/', form).then(res => {\r\n          let error_code = res.data.error_code\r\n          if (error_code === 0) {\r\n            this.userImg = res.data.img_proc_result\r\n            this.savedImg = this.userImg\r\n          } else if (error_code === 1008) {\r\n            this.$message.error('出错啦，没有检测到人脸')\r\n          }\r\n          this.fullScreenLoading = false\r\n        }).catch(err => {\r\n          console.log(err)\r\n          this.$message.error('出错啦，请检查您的网络连接')\r\n          this.fullScreenLoading = false\r\n        })\r\n      }\r\n    },\r\n    handleSubClick (label) {\r\n      let index = this.subModules.findIndex(value => value == this.currentSubModule)\r\n      if (index <= 0) { // 重置\r\n        this.reset()\r\n        // console.log('重置')\r\n      }\r\n      else {\r\n        if (this.currentModule == '磨皮') {\r\n          // TODO:调用后端接口\r\n          this.fullScreenLoading = true\r\n          let form = new FormData()\r\n          form.append('buffer_degree', this.degreeList[0][index])\r\n          form.append('editedImg', this.savedImg)\r\n          axios.post('imgProc/beautify_buffering/', form).then(res => {\r\n            let error_code = res.data.error_code\r\n            if (error_code === 0) {\r\n              this.userImg = res.data.img_proc_result\r\n            } else if (error_code === 1008) {\r\n              this.$message.error('出错啦，请稍后再试')\r\n            }\r\n            this.fullScreenLoading = false\r\n          }).catch(err => {\r\n            console.log(err)\r\n            this.$message.error('出错啦，请检查您的网络连接')\r\n            this.fullScreenLoading = false\r\n          })\r\n          // console.log('磨皮参数：', this.degreeList[0][index])\r\n        }\r\n        else if (this.currentModule == '美白') {\r\n          // TODO:调用后端接口\r\n          this.fullScreenLoading = true\r\n          let form = new FormData()\r\n          form.append('white_degree', this.degreeList[1][index])\r\n          form.append('editedImg', this.savedImg)\r\n          axios.post('imgProc/beautify_white/', form).then(res => {\r\n            let error_code = res.data.error_code\r\n            if (error_code === 0) {\r\n              this.userImg = res.data.img_proc_result\r\n            } else if (error_code === 1008) {\r\n              this.$message.error('出错啦，请稍后再试')\r\n            }\r\n            this.fullScreenLoading = false\r\n          }).catch(err => {\r\n            console.log(err)\r\n            this.$message.error('出错啦，请检查您的网络连接')\r\n            this.fullScreenLoading = false\r\n          })\r\n          // console.log('美白参数：', this.degreeList[1][index])\r\n        }\r\n      }\r\n    }\r\n  },\r\n  activated () {\r\n    this.currentModule = '磨皮'\r\n    this.reset()\r\n    // console.log('activated')\r\n  },\r\n}\r\n</script>\r\n<style lang=\"css\" scoped>\r\n.face-proc {\r\n  /* 默认值居然不是100%高度 */\r\n  height: 100%;\r\n}\r\n\r\n.el-header {\r\n  padding: 0;\r\n}\r\n\r\n.el-main {\r\n  height: calc(90vh - 80px);\r\n}\r\n\r\n.img-container {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 100%;\r\n  object-fit: scale-down;\r\n  margin: 0 auto;\r\n}\r\n\r\n#image {\r\n  max-height: 100%;\r\n  max-width: 100%;\r\n  margin: 0 auto;\r\n}\r\n\r\n#cropper-cpn {\r\n  max-height: 100%;\r\n  object-fit: scale-down;\r\n}\r\n\r\n.el-footer {\r\n  position: absolute;\r\n  bottom: 21px;\r\n  max-width: 100%;\r\n}\r\n\r\n.sub-modules {\r\n  display: flex;\r\n  overflow: hidden;\r\n  overflow-x: scroll;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FaceProc.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FaceProc.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FaceProc.vue?vue&type=template&id=7b323f56&scoped=true&\"\nimport script from \"./FaceProc.vue?vue&type=script&lang=js&\"\nexport * from \"./FaceProc.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FaceProc.vue?vue&type=style&index=0&id=7b323f56&lang=css&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7b323f56\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}