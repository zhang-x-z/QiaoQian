{"version":3,"sources":["webpack:///./src/views/Mobile/process/SwapView.vue?409e","webpack:///./src/views/Mobile/process/SwapView.vue?95c2","webpack:///src/views/Mobile/process/SwapView.vue","webpack:///./src/views/Mobile/process/SwapView.vue?6970","webpack:///./src/views/Mobile/process/SwapView.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","scopedSlots","_u","key","fn","on","back","proxy","_v","finish","directives","name","rawName","value","expression","attrs","hasRes","userImg","otherImg","_e","handleChange","handleExceed","files","staticStyle","slot","swap","staticRenderFns","a","data","fullScreenLoading","canProc","mounted","init","activated","methods","$store","state","editedImg","$router","commit","$message","error","reader","readAsDataURL","file","raw","onload","form","append","error_code","console","log","err","components","NavBar","component"],"mappings":"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","file":"js/chunk-100e7ede.377ff483.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwapView.vue?vue&type=style&index=0&id=5ab4ea16&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwapView.vue?vue&type=style&index=0&id=5ab4ea16&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"swapview-wapper\"},[_c('div',{staticClass:\"navbar-wapper\"},[_c('nav-bar',{scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('i',{staticClass:\"el-icon-back\",on:{\"click\":_vm.back}})]},proxy:true},{key:\"center\",fn:function(){return [_c('span',[_vm._v(\"换脸\")])]},proxy:true},{key:\"right\",fn:function(){return [_c('i',{staticClass:\"el-icon-check\",on:{\"click\":_vm.finish}})]},proxy:true}])})],1),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.fullScreenLoading),expression:\"fullScreenLoading\"}],attrs:{\"element-loading-text\":\"处理中...\",\"element-loading-background\":\"rgba(0, 0, 0, 0.6)\"}},[_c('div',{staticClass:\"content-wapper\"},[(!_vm.hasRes)?_c('div',[_c('div',{staticClass:\"image-one\"},[_c('img',{staticClass:\"face\",attrs:{\"src\":_vm.userImg}})]),_c('div',{staticClass:\"image-two\"},[(_vm.canProc)?_c('img',{staticClass:\"face\",attrs:{\"src\":_vm.otherImg}}):_vm._e()])]):_c('div',[_c('div',{staticClass:\"image-result\"},[_c('img',{staticClass:\"face\",attrs:{\"src\":_vm.userImg}})])])])]),_c('div',{staticClass:\"buttons-wapper\"},[_c('el-upload',{staticClass:\"upload\",attrs:{\"action\":\"#\",\"limit\":1,\"on-change\":_vm.handleChange,\"on-exceed\":_vm.handleExceed,\"auto-upload\":false,\"show-file-list\":false,\"file-list\":_vm.files}},[_c('el-button',{staticStyle:{\"height\":\"7vh\",\"width\":\"48vw\",\"font-size\":\"20px\"},attrs:{\"slot\":\"trigger\",\"plain\":\"\"},slot:\"trigger\"},[_vm._v(\"上传图片\")])],1),_c('el-button',{staticStyle:{\"height\":\"7vh\",\"width\":\"48vw\",\"font-size\":\"20px\"},attrs:{\"plain\":\"\"},on:{\"click\":_vm.swap}},[_vm._v(\"开始转换\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"swapview-wapper\">\r\n    <div class=\"navbar-wapper\">\r\n      <nav-bar>\r\n        <template v-slot:left>\r\n          <i class=\"el-icon-back\" @click=\"back\"></i>\r\n        </template>\r\n        <template v-slot:center>\r\n          <span>换脸</span>\r\n        </template>\r\n        <template v-slot:right>\r\n          <i class=\"el-icon-check\" @click=\"finish\"></i>\r\n        </template>\r\n      </nav-bar>\r\n    </div>\r\n    <div\r\n      v-loading=\"fullScreenLoading\"\r\n      element-loading-text=\"处理中...\"\r\n      element-loading-background=\"rgba(0, 0, 0, 0.6)\"\r\n    >\r\n      <div class=\"content-wapper\">\r\n        <div v-if=\"!hasRes\">\r\n          <div class=\"image-one\">\r\n            <img :src=\"userImg\" class=\"face\" />\r\n          </div>\r\n          <div class=\"image-two\">\r\n            <img v-if=\"canProc\" :src=\"otherImg\" class=\"face\" />\r\n          </div>\r\n        </div>\r\n        <div v-else>\r\n          <div class=\"image-result\">\r\n            <img :src=\"userImg\" class=\"face\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"buttons-wapper\">\r\n      <el-upload\r\n        action=\"#\"\r\n        :limit=\"1\"\r\n        :on-change=\"handleChange\"\r\n        :on-exceed=\"handleExceed\"\r\n        :auto-upload=\"false\"\r\n        :show-file-list=\"false\"\r\n        :file-list=\"files\"\r\n        class=\"upload\"\r\n      >\r\n        <el-button plain slot=\"trigger\" style=\"height:7vh;width:48vw;font-size:20px\">上传图片</el-button>\r\n      </el-upload>\r\n      <el-button plain style=\"height:7vh;width:48vw;font-size:20px\" @click=\"swap\">开始转换</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from '@/components/common/Mobile/NavBar'\r\nimport axios from 'axios'\r\nimport { baseurl } from '@/utils.js'\r\n//TODO: need to change\r\naxios.defaults.baseURL = baseurl()\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      userImg: '',\r\n      otherImg: '',\r\n      files: [],\r\n      fullScreenLoading: false,\r\n      canProc: false,\r\n      hasRes: false\r\n    }\r\n  },\r\n  mounted () {\r\n    this.init()\r\n  },\r\n  activated () {\r\n    this.init()\r\n  },\r\n  methods: {\r\n    init () {\r\n      this.userImg = this.$store.state.editedImg\r\n      this.otherImg = ''\r\n      this.canProc = false\r\n      this.fullScreenLoading = false\r\n      this.files = []\r\n    },\r\n    back () {\r\n      this.$router.back()\r\n    },\r\n    finish () {\r\n      this.$store.commit('saveImg', this.userImg)\r\n      this.$router.back()\r\n    },\r\n    handleExceed () {\r\n      this.$message.error('不能再上传啦')\r\n    },\r\n    handleChange (file, fileList) {\r\n      if (this.hasRes) {\r\n        this.hasRes = false\r\n      }\r\n      let reader = new FileReader()\r\n      reader.readAsDataURL(file.raw)\r\n      reader.onload = (event) => {\r\n        let imgUrl = event.target.result\r\n        this.otherImg = imgUrl\r\n        this.canProc = true\r\n        // console.log('in')\r\n      }\r\n    },\r\n    swap () {\r\n      if (this.canProc) {\r\n        this.fullScreenLoading = true\r\n        let form = new FormData()\r\n        form.append('headImg', this.userImg)\r\n        form.append('faceImg', this.otherImg)\r\n        axios.post('imgProc/faceswap/', form).then(res => {\r\n          let error_code = res.data.error_code\r\n          if (error_code === 0) {\r\n            this.userImg = res.data.img_proc_result\r\n            this.canProc = false\r\n            this.hasRes = true\r\n            this.files = []\r\n            this.otherImg = ''\r\n          } else if (error_code === 1008) {\r\n            this.$message.error('出错啦，请检查图片里面是否只有一张脸')\r\n          }\r\n          this.fullScreenLoading = false\r\n        }).catch(err => {\r\n          console.log(err)\r\n          this.$message.error('出错啦，请检查您的网络连接')\r\n          this.fullScreenLoading = false\r\n        })\r\n      } else {\r\n        this.$message.error('请再上传一张照片')\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    NavBar\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.swapview-wapper {\r\n  background-color: #eeeeee;\r\n  position: relative;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.navbar-wapper {\r\n  background-color: rgba(250, 251, 252, 224);\r\n  position: sticky;\r\n  position: -webkit-sticky;\r\n  top: 0;\r\n  z-index: 100;\r\n  font-size: 22px;\r\n}\r\n\r\n.content-wapper {\r\n  margin-top: 2vh;\r\n  margin-bottom: 2vh;\r\n  margin-left: 2vw;\r\n  margin-right: 2vw;\r\n  height: 81vh;\r\n  width: 96vw;\r\n  display: block;\r\n}\r\n\r\n.image-one {\r\n  height: 39vh;\r\n  width: 96vw;\r\n  margin-bottom: 3vh;\r\n}\r\n\r\n.image-two {\r\n  height: 39vh;\r\n  width: 96vw;\r\n}\r\n\r\n.face {\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: 0 auto;\r\n  object-fit: scale-down;\r\n}\r\n\r\n.image-result {\r\n  height: 81vh;\r\n  width: 96vw;\r\n}\r\n\r\n.buttons-wapper {\r\n  display: flex;\r\n  justify-content: space-around;\r\n  margin-bottom: 1vh;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwapView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwapView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SwapView.vue?vue&type=template&id=5ab4ea16&scoped=true&\"\nimport script from \"./SwapView.vue?vue&type=script&lang=js&\"\nexport * from \"./SwapView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SwapView.vue?vue&type=style&index=0&id=5ab4ea16&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5ab4ea16\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}