(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9da7dc96"],{"0cf1":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"always"}},[t._t("image"),a("div",{staticStyle:{padding:"14px"}},[t._t("title"),a("div",{staticClass:"bottom clearfix"},[t._t("describe"),t._t("button")],2)],2)],2)},i=[],o={},s=o,n=(a("9b82"),a("2877")),c=Object(n["a"])(s,r,i,!1,null,"41d46507",null);e["a"]=c.exports},"35fd":function(t,e,a){},5232:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"albumpage-wapper"},[a("div",{staticClass:"navbar-wapper"},[a("nav-bar",[a("div",{attrs:{slot:"left"},on:{click:function(e){return t.Back()}},slot:"left"},[a("i",{staticClass:"el-icon-caret-left"})]),a("div",{staticClass:"title",attrs:{slot:"center"},slot:"center"},[t._v(t._s(this.$store.state.currentAlbumInfo.name))]),a("div",{attrs:{slot:"right"},slot:"right"},[a("i",{staticClass:"el-icon-upload",on:{click:function(e){return t.uploadPhoto()}}})])])],1),a("el-dialog",{attrs:{title:"上传照片",visible:t.dialogFormVisible,width:"70%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-upload",{staticStyle:{"text-align":"center"},attrs:{action:"https://jsonplaceholder.typicode.com/posts/","list-type":"picture card",accept:".jpg,.png","http-request":t.uploadImageRequest,"show-file-list":!1,"on-success":t.handleSuccess,"on-error":t.handleError}},[a("i",{staticClass:"el-icon-plus"})])],1),a("photo-wall",{attrs:{imageInfo:t.imageInfo,canEdit:"true"}})],1)},i=[],o=(a("b0c0"),a("6259")),s=a("aee2"),n=a("bc3a"),c=a.n(n),l=a("025e");c.a.defaults.baseURL=Object(l["a"])();var u={name:"album-page",data:function(){return{imageInfo:[],dialogFormVisible:!1,rules:{name:[{required:!0,message:"相册名不能为空！",trigger:"blur"}]}}},watch:{},mounted:function(){var t=this;null!==this.$store.state.currentAlbumInfo&&this.$store.state.isLogin?c.a.get("user/getImagesInfo/",{params:{user_id:this.$store.state.user.userID,album_id:this.$store.state.currentAlbumInfo.id},timeout:5e3}).then((function(t){return t.data})).then((function(e){var a=e.error_code;0===a?t.imageInfo=e.ImagesInfo:1006===a&&t.$message.error("加载失败，请稍后再试~")})).catch((function(e){console.log(e),t.$message.error("加载失败，请检查您的网络连接")})):this.$router.push("/")},components:{NavBar:o["a"],PhotoWall:s["a"]},methods:{uploadImageRequest:function(t){var e=this;if(t.file.size/1024/1024>10)this.$message.error("您上传的图片太大啦，请选择不超过10M的图片"),t.onError();else{var a=new FormData;a.append("user_id",this.$store.state.user.userID),a.append("album_id",this.$store.state.currentAlbumInfo.id),a.append("image",t.file,t.file.name),c.a.post("user/add-image/",a,{timeout:5e3}).then((function(t){return t.data})).then((function(a){var r=a.error_code;0===r?(e.imageInfo.unshift(a.imageInfo),e.$store.commit("updateAlbum",{num:1,url:a.imageInfo.url}),t.onSuccess()):1006===r&&t.onError()})).catch((function(e){console.log(e),t.onError()}))}},Back:function(){this.$router.back(-1)},uploadPhoto:function(){this.dialogFormVisible=!0},handleSuccess:function(){this.$message.success("上传成功!")},handleError:function(){this.$message.error("上传失败!")}}},d=u,m=(a("8036"),a("2877")),f=Object(m["a"])(d,r,i,!1,null,"67c9e744",null);e["default"]=f.exports},8036:function(t,e,a){"use strict";var r=a("a823"),i=a.n(r);i.a},"9b82":function(t,e,a){"use strict";var r=a("a7ef"),i=a.n(r);i.a},a7ef:function(t,e,a){},a823:function(t,e,a){},aee2:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"photo-wall-wapper"},[a("el-dialog",{attrs:{title:"详细信息",visible:t.dialogFormVisible,width:"70%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("p",[t._v("图片名称："+t._s(t.currentImage.name))]),a("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("图片大小："+t._s(t.currentImage.size))]),a("p",[t._v("上传时间："+t._s(t.currentImage.date))]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-popconfirm",{attrs:{slot:"button",confirmButtonText:"确认",cancelButtonText:"手抖了",icon:"el-icon-warning",iconColor:"red",title:"确定删除该图片吗？"},on:{onConfirm:function(e){return t.deletePhoto()}},slot:"button"},[a("el-button",{staticStyle:{"margin-right":"3vh"},attrs:{slot:"reference",plain:"",type:"danger"},slot:"reference"},[t._v("删 除")])],1),a("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("确 定")])],1)]),a("div",{ref:"scroll",staticClass:"scroll-wapper"},[a("div",{staticClass:"scroll-content"},t._l(t.imageInfo,(function(e){return a("album-card",{key:e.id,staticStyle:{"margin-bottom":"5%","margin-right":"1.3%","margin-left":"1.3%",width:"30%",height:"20%"}},[a("el-image",{staticClass:"image",attrs:{slot:"image",fit:"cover",src:e.url,"preview-src-list":t.imageUrls},on:{load:t.onLoadSuccess,error:t.onLoadError},slot:"image"}),a("i",{staticClass:"el-icon-more more-btn",attrs:{slot:"describe"},on:{click:function(a){return t.showImageInfo(e)}},slot:"describe"}),t.canEdit?a("i",{staticClass:"el-icon-magic-stick edit-btn",attrs:{slot:"button"},on:{click:function(a){return t.toEdit(e)}},slot:"button"}):t._e()],1)})),1)])],1)},i=[],o=(a("d81d"),a("a434"),a("0cf1")),s=a("1fba"),n=a("bc3a"),c=a.n(n),l=a("025e");c.a.defaults.baseURL=Object(l["a"])();var u={click:!0,scrollbar:{fade:!0,interactive:!1}},d={data:function(){return{dialogFormVisible:!1,currentImage:{}}},props:{imageInfo:Array,canEdit:!1},watch:{imageInfo:function(){var t=this;setTimeout((function(){t.bs.refresh()}),20)}},computed:{imageUrls:function(){return this.imageInfo.map((function(t){return t.url}))}},mounted:function(){var t=this;setTimeout((function(){t.bs=new s["a"](t.$refs.scroll,u)}),20)},components:{AlbumCard:o["a"]},methods:{onLoadSuccess:function(t){var e=this;setTimeout((function(){e.bs.refresh()}),20)},onLoadError:function(t){var e=this;setTimeout((function(){e.bs.refresh()}),20)},toEdit:function(t){var e=this;c.a.get("user/get-image-base64/",{params:{image_id:t.id},timeout:3e3}).then((function(t){var a=t.data.error_code;if(0===a){var r=t.data.image;e.$store.commit("saveImg",r),e.$router.push("/imgProc")}else 1006===a&&e.$message.error("获取图片失败，请稍后再试")})).catch((function(t){console.log(t),e.$message.error("获取图片失败，请检查您的网络连接")}))},showImageInfo:function(t){this.currentImage=t,this.dialogFormVisible=!0},deletePhoto:function(){var t=this;if(this.canEdit){var e=new FormData;e.append("user_id",this.$store.state.user.userID),e.append("album_id",this.$store.state.currentAlbumInfo.id),e.append("image_id",this.currentImage.id),c.a.post("user/delete-image/",e,{timeout:3e3}).then((function(e){var a=e.data.error_code;if(0===a){for(var r=-1,i=0;i<t.imageInfo.length;i++)if(t.imageInfo[i].id===t.currentImage.id){r=i;break}t.imageInfo.splice(r,1),t.$store.commit("updateAlbum",{num:-1,url:e.data.album_cover_url}),t.$message.success("删除成功!"),t.dialogFormVisible=!1}else 1006===a&&t.$message.error("删除失败，请您稍后再试")})).catch((function(e){console.log(e),t.$message.error("删除失败，请检查您的网络连接")}))}else{var a=new FormData;a.append("user_id",this.$store.state.user.userID),a.append("sticker_id",this.currentImage.id),c.a.post("user/delete-sticker/",a,{timeout:3e3}).then((function(e){var a=e.data.error_code;if(0===a){for(var r=-1,i=0;i<t.imageInfo.length;i++)if(t.imageInfo[i].id===t.currentImage.id){r=i;break}t.imageInfo.splice(r,1),t.$message.success("删除成功!"),t.dialogFormVisible=!1}else 1006===a&&t.$message.error("删除失败，请您稍后再试")})).catch((function(e){console.log(e),t.$message.error("删除失败，请检查您的网络连接")}))}}}},m=d,f=(a("da8a"),a("2877")),g=Object(f["a"])(m,r,i,!1,null,"3872f41b",null);e["a"]=g.exports},b0c0:function(t,e,a){var r=a("83ab"),i=a("9bf2").f,o=Function.prototype,s=o.toString,n=/^\s*function ([^ (]*)/,c="name";r&&!(c in o)&&i(o,c,{configurable:!0,get:function(){try{return s.call(this).match(n)[1]}catch(t){return""}}})},d81d:function(t,e,a){"use strict";var r=a("23e7"),i=a("b727").map,o=a("1dde"),s=a("ae40"),n=o("map"),c=s("map");r({target:"Array",proto:!0,forced:!n||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},da8a:function(t,e,a){"use strict";var r=a("35fd"),i=a.n(r);i.a}}]);
//# sourceMappingURL=chunk-9da7dc96.ceae1987.js.map